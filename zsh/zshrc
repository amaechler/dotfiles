# volta (node / npm manager) configuration
export VOLTA_HOME="$HOME/.volta"
export PATH="$VOLTA_HOME/bin:$PATH"
export VOLTA_FEATURE_PNPM=1 # enable experimental pnpm support

# add .local/bin to PATH for user installed binaries
export PATH="$HOME/.local/bin:$PATH"

# Set up fpath for all completions FIRST
if type brew &>/dev/null; then
  FPATH="$(brew --prefix)/share/zsh/site-functions:${FPATH}"
fi

# Docker completions
fpath=(/Users/amaechler/.docker/completions $fpath)

# Initialize completions ONCE with caching (rebuild cache daily)
autoload -Uz compinit
if [[ -n ${ZDOTDIR}/.zcompdump(#qN.mh+24) ]]; then
  compinit
else
  compinit -C
fi

# zsh-autosuggestions, suggests commands in grey
source /opt/homebrew/share/zsh-autosuggestions/zsh-autosuggestions.zsh

# Enhanced completion settings
zstyle ':completion:*' menu select # Arrow key navigation in completion menu
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}' 'r:|[._-]=* r:|=*' 'l:|=* r:|=*' # Case-insensitive + fuzzy matching
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}" # Colored completions
zstyle ':completion:*:parameters' ignored-patterns '_*' # Hide internal parameters
setopt AUTO_MENU # Show completion menu on successive tab press
setopt COMPLETE_IN_WORD # Complete from both ends of word
setopt ALWAYS_TO_END # Move cursor to end after completion

# autojump
[ -f /opt/homebrew/etc/profile.d/autojump.sh ] && . /opt/homebrew/etc/profile.d/autojump.sh

# custom aliases
alias ll="ls -AlG"
alias tsh-int="tsh login --proxy=tp.eng.imply.io:443 --auth=local --user=andy.maechler@imply.io tp.eng.imply.io"
alias tsh-ext="tsh login --proxy=tp.imply.io:443 --auth=local --user=andy.maechler@imply.io teleport-ext"

# run oh-my-posh
eval "$(oh-my-posh init zsh --config ~/Development/Personal/dotfiles/oh-my-posh/oh-my-posh-amaechler.omp.json)"

# zsh-syntax-highlighting - highlights commands as you type (must be at end)
source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

# sdkman configuration - needs to be at the end of file
export SDKMAN_DIR="$HOME/.sdkman"
[[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]] && source "$HOME/.sdkman/bin/sdkman-init.sh"
